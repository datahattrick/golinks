# -- Number of replicas (ignored if autoscaling is enabled)
replicaCount: 1

# -- Image configuration
image:
  # -- Container image repository
  repository: ghcr.io/datahattrick/golinks
  # -- Image pull policy
  pullPolicy: IfNotPresent
  # -- Overrides the image tag (default is the chart appVersion)
  tag: ""

# -- Image pull secrets for private registries
imagePullSecrets: []
# -- Override the chart name
nameOverride: ""
# -- Override the full release name
fullnameOverride: ""

# =============================================================================
# Service Account
# =============================================================================
serviceAccount:
  # -- Create a service account
  create: true
  # -- Annotations for the service account
  annotations: {}
  # -- Name of the service account (auto-generated if not set)
  name: ""
  # -- Automount API credentials
  automountServiceAccountToken: false

# =============================================================================
# Pod Configuration
# =============================================================================
# -- Annotations to add to pods
podAnnotations: {}

# -- Labels to add to pods
podLabels: {}

# -- Pod security context (OpenShift compatible - no runAsUser)
podSecurityContext:
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

# -- Container security context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true

# =============================================================================
# Service Configuration
# =============================================================================
service:
  # -- Service type
  type: ClusterIP
  # -- Service port
  port: 3000
  # -- Service annotations
  annotations: {}

# =============================================================================
# Ingress Configuration (Kubernetes)
# =============================================================================
ingress:
  # -- Enable ingress
  enabled: false
  # -- Ingress class name
  className: ""
  # -- Ingress annotations
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  # -- Ingress hosts configuration
  hosts:
    - host: golinks.local
      paths:
        - path: /
          pathType: Prefix
  # -- TLS configuration
  tls: []
  #  - secretName: golinks-tls
  #    hosts:
  #      - golinks.local

# =============================================================================
# OpenShift Route Configuration
# =============================================================================
route:
  # -- Enable OpenShift Route (mutually exclusive with ingress)
  enabled: false
  # -- Route hostname (auto-generated if empty)
  host: ""
  # -- Route path
  path: /
  # -- Route annotations
  annotations: {}
  # -- TLS configuration
  tls:
    # -- Enable TLS
    enabled: true
    # -- TLS termination type (edge, passthrough, reencrypt)
    termination: edge
    # -- Insecure traffic policy (Allow, Redirect, None)
    insecureEdgeTerminationPolicy: Redirect

# =============================================================================
# Resources
# =============================================================================
resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# =============================================================================
# Probes
# =============================================================================
# -- Liveness probe configuration
livenessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1

# -- Readiness probe configuration
readinessProbe:
  httpGet:
    path: /readyz
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3
  successThreshold: 1

# -- Startup probe configuration (for slow-starting containers)
startupProbe: {}
  # httpGet:
  #   path: /readyz
  #   port: http
  # failureThreshold: 30
  # periodSeconds: 10
  # httpGet:
  #   path: /
  #   port: http
  # failureThreshold: 30
  # periodSeconds: 10

# =============================================================================
# Autoscaling
# =============================================================================
autoscaling:
  # -- Enable horizontal pod autoscaling
  enabled: false
  # -- Minimum replicas
  minReplicas: 1
  # -- Maximum replicas
  maxReplicas: 10
  # -- Target CPU utilization percentage
  targetCPUUtilizationPercentage: 80
  # -- Target memory utilization percentage
  targetMemoryUtilizationPercentage: ""

# =============================================================================
# Pod Disruption Budget
# =============================================================================
podDisruptionBudget:
  # -- Enable PodDisruptionBudget
  enabled: false
  # -- Minimum available pods (mutually exclusive with maxUnavailable)
  minAvailable: 1
  # -- Maximum unavailable pods
  maxUnavailable: ""

# =============================================================================
# Scheduling
# =============================================================================
# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# -- Affinity rules
affinity: {}

# -- Topology spread constraints
topologySpreadConstraints: []

# =============================================================================
# Application Configuration
# =============================================================================
config:
  # -- Server listen address
  serverAddr: ":3000"
  # -- Public base URL for redirects and callbacks
  baseURL: "https://go.example.com"
  # -- Environment (development, production)
  environment: "production"

  # -- Log level (debug, info, warn, error)
  logLevel: "info"

  # -- Site branding
  branding:
    # -- Site title displayed in header
    title: "GoLinks"
    # -- Tagline displayed on home page
    tagline: "Quick links for your organization"
    # -- Footer text
    footer: ""
    # -- URL to logo image
    logoURL: ""
    # -- Enable animated background (default: false for performance; set to true for animated gradient and floating nodes)
    animatedBackground: false

  # -- Site banner (displayed at the top of every page when text is set)
  banner:
    # -- Banner text (leave empty to disable)
    text: ""
    # -- Banner text color
    textColor: "#ffffff"
    # -- Banner background color
    bgColor: "#0891b2"

  # -- Feature toggles
  features:
    # -- Enable "I'm Feeling Lucky" random link feature
    randomKeywords: false
    # -- Enable personal link scopes
    personalLinks: true
    # -- Enable organization link scopes
    orgLinks: true

  # -- Health check settings
  healthCheck:
    # -- Interval between health checks
    interval: "1h"
    # -- Maximum age before re-checking
    maxAge: "24h"

# =============================================================================
# OIDC Authentication
# =============================================================================
oidc:
  # -- OIDC issuer URL (required)
  issuer: ""
  # -- OIDC client ID
  clientId: ""
  # -- OAuth callback URL (usually baseURL + /auth/callback)
  redirectURL: ""
  # -- OIDC scopes to request
  scopes: "openid profile email"

  # -- Claim mappings
  claims:
    # -- Claim name for user's organization
    org: "organisation"
    # -- Claim name for user's groups
    groups: "groups"

  # -- Group-to-role mapping (optional)
  # When configured, user roles are derived from OIDC groups on every login
  roleMapping:
    # -- OIDC groups that grant admin role (comma-separated)
    adminGroups: ""
    # -- OIDC groups that grant moderator role (comma-separated)
    moderatorGroups: ""

# =============================================================================
# Database Configuration
# =============================================================================
database:
  # -- External database configuration
  external:
    # -- Use external database (if false, DATABASE_URL must be in existingSecret)
    enabled: true
    # -- Database host
    host: ""
    # -- Database port
    port: 5432
    # -- Database name
    name: "golinks"
    # -- Database user
    user: "golinks"
    # -- SSL mode (disable, require, verify-ca, verify-full)
    sslMode: "require"

  # -- Existing secret containing DATABASE_URL
  existingSecret: ""
  # -- Key in existingSecret for DATABASE_URL
  existingSecretKey: "DATABASE_URL"

# =============================================================================
# Secrets
# =============================================================================
# -- Existing secret for sensitive values
# Required keys: SESSION_SECRET, OIDC_CLIENT_SECRET
# Optional keys: DATABASE_URL, SMTP_PASSWORD
existingSecret: ""

# =============================================================================
# TLS / mTLS Configuration
# =============================================================================
tls:
  # -- Enable TLS termination at the application level
  enabled: false
  # -- Path to TLS certificate
  certFile: ""
  # -- Path to TLS private key
  keyFile: ""
  # -- Path to CA file for client cert verification (mTLS)
  caFile: ""
  # -- Existing secret containing TLS certificates
  existingSecret: ""

# =============================================================================
# SMTP Email Configuration
# =============================================================================
smtp:
  # -- Enable email notifications
  enabled: false
  # -- SMTP server hostname
  host: ""
  # -- SMTP server port
  port: 587
  # -- SMTP username
  username: ""
  # -- Sender email address
  from: ""
  # -- Sender display name
  fromName: "GoLinks"
  # -- TLS mode (none, starttls, tls)
  tlsMode: "starttls"

# -- Email notification settings
emailNotifications:
  # -- Notify moderators when a link is submitted
  notifyModsOnSubmit: true
  # -- Notify users when their link is approved
  notifyUserOnApproval: true
  # -- Notify users when their link is rejected
  notifyUserOnRejection: true
  # -- Notify users when their link is deleted
  notifyUserOnDeletion: true
  # -- Notify moderators on health check failures
  notifyModsOnHealthFailure: true

# =============================================================================
# Additional Configuration
# =============================================================================
# -- Extra environment variables
extraEnv: []
#  - name: MY_VAR
#    value: "my-value"

# -- Extra environment variables from ConfigMaps or Secrets
extraEnvFrom: []
#  - configMapRef:
#      name: my-configmap
#  - secretRef:
#      name: my-secret

# -- Extra volumes
extraVolumes: []

# -- Extra volume mounts
extraVolumeMounts: []

# -- Init containers
initContainers: []

# -- Sidecar containers
sidecars: []
